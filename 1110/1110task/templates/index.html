<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>íŒŒë€ìƒ‰ ê°ì²´ CAPTCHA</title>
    <style>
        .container { display: flex; gap: 20px; max-width: 900px; margin: 0 auto; }
        .challenge-area { flex: 1; text-align: center; }
        .grid-container { 
            width: 300px; height: 300px; 
            background-image: url('{{ url_for('static', filename=challenge_image) }}'); 
            background-size: cover;
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            grid-template-rows: repeat(3, 1fr); 
            border: 2px solid #ccc;
        }
        .grid-item {
            border: 1px solid rgba(0, 0, 0, 0.2); 
            position: relative; 
            cursor: pointer;
        }
        .grid-item input[type="checkbox"] {
            position: absolute;
            opacity: 0; /* ì²´í¬ë°•ìŠ¤ ìˆ¨ê¸°ê¸° */
            width: 100%; height: 100%;
            margin: 0;
            cursor: pointer;
            z-index: 10;
        }
        .grid-item.selected {
            background-color: rgba(0, 123, 255, 0.3); /* ì„ íƒëœ íƒ€ì¼ í‘œì‹œ */
        }
        .hint-area { flex: 1; }
    </style>
</head>
<body>
    <h1>ğŸ» "ë¡œë´‡ì´ ì•„ë‹™ë‹ˆë‹¤" - íŒŒë€ìƒ‰ ê°ì²´ ì°¾ê¸°</h1>
    <p>ì•„ë˜ 3x3 ê²©ì ì´ë¯¸ì§€ì—ì„œ **íŒŒë€ìƒ‰ ê°ì²´ì˜ ì‹¤ë£¨ì—£**ì— í•´ë‹¹í•˜ëŠ” ëª¨ë“  íƒ€ì¼ì„ ì„ íƒí•˜ì„¸ìš”.</p>
    
    <div class="container">
        <div class="challenge-area">
            <h2>ë„ì „ ê³¼ì œ</h2>
            <form method="POST" action="{{ url_for('verify') }}" id="captchaForm">
                <div class="grid-container" id="captchaGrid">
                    {% for i in range(9) %}
                    <div class="grid-item" data-index="{{ i }}">
                        <input type="checkbox" name="selected_tiles" value="{{ i }}">
                    </div>
                    {% endfor %}
                </div>
                <button type="submit" style="margin-top: 20px;">ì¸ì¦</button>
            </form>
        </div>

        <div class="hint-area">
            <h2>ì‹¤ë£¨ì—£ íŒíŠ¸ (ë””ë²„ê¹…ìš©)</h2>
            <p>ì›ë³¸ ì´ë¯¸ì§€ì˜ íŒŒë€ìƒ‰ ì‹¤ë£¨ì—£ ë§ˆìŠ¤í¬ì…ë‹ˆë‹¤.</p>
            <img src="{{ url_for('static', filename=silhouette_image) }}" style="width: 300px; border: 1px solid #ccc;">
            <p>ë¶„í• ëœ ê°ì²´ (ë””ë²„ê¹…ìš©)</p>
            <img src="{{ url_for('static', filename=segmented_image) }}" style="width: 300px; border: 1px solid #ccc;">
            
            {% if correct_tiles %}
            <p style="color: red;">[DEBUG] ì •ë‹µ íƒ€ì¼ ì¸ë±ìŠ¤: {{ correct_tiles }}</p>
            {% endif %}
        </div>
    </div>
    
    <script>
        document.getElementById('captchaGrid').addEventListener('click', function(e) {
            const item = e.target.closest('.grid-item');
            if (item) {
                const checkbox = item.querySelector('input[type="checkbox"]');
                // ì²´í¬ë°•ìŠ¤ì˜ ìƒíƒœë¥¼ í† ê¸€í•©ë‹ˆë‹¤.
                checkbox.checked = !checkbox.checked;
                // ì„ íƒëœ ìƒíƒœë¥¼ ì‹œê°ì ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.
                item.classList.toggle('selected', checkbox.checked);
            }
        });
    </script>
</body>
</html>